module.exports=[40777,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){return(0,b.jsxs)("header",{className:"chat-header",children:[(0,b.jsx)("h1",{className:"chat-title",children:"AI WooCommerce Uploader"}),(0,b.jsx)("p",{className:"chat-subtitle",children:"Crea productos con inteligencia artificial"})]})}function e({loading:a,currentMessage:c,currentStep:d,input:e,setInput:f,handleSendMessage:g,handleSkip:h,error:i,uploadSuccess:j}){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"ai-message",children:(0,b.jsxs)("div",{className:"message-bubble",children:[a&&(0,b.jsxs)("div",{className:"loading-dots",children:[(0,b.jsx)("span",{}),(0,b.jsx)("span",{}),(0,b.jsx)("span",{})]}),(0,b.jsx)("p",{children:c})]})}),"complete"!==d&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("form",{onSubmit:g,className:"chat-input-form",children:(0,b.jsxs)("div",{className:"input-container",children:[(0,b.jsx)("input",{type:"text",value:e,onChange:a=>f(a.target.value),placeholder:"Escribe tu respuesta...",className:"chat-input",disabled:a,autoFocus:!0}),(0,b.jsx)("button",{type:"submit",disabled:a||!e.trim(),className:"send-button","aria-label":"Enviar",children:(0,b.jsx)("svg",{className:"icon-send",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})}),(0,b.jsx)("button",{type:"button",className:"skip-button",onClick:h,disabled:a,children:"Saltar este paso"})]}),i&&(0,b.jsxs)("div",{className:"alert alert-error",children:[(0,b.jsx)("svg",{className:"icon-alert",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,b.jsx)("p",{children:i})]}),j&&(0,b.jsxs)("div",{className:"alert alert-success",children:[(0,b.jsx)("svg",{className:"icon-alert",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,b.jsx)("p",{children:j})]})]})}let f={publish:"Publicado",draft:"Borrador",pending:"Pendiente",private:"Privado"};function g({result:a,downloadCSV:c,handleUpload:d,resetChat:e,uploading:g}){let h=a?.product;if(!h)return null;let i=h?.tags??[],j=h?.categories??[],k=h?.images??[],l=h?.status?f[h.status]??h.status:null,m=!!(h?.dimensions&&(h.dimensions.length||h.dimensions.width||h.dimensions.height));return(0,b.jsxs)("div",{className:"product-result",children:[(0,b.jsxs)("div",{className:"product-header",children:[(0,b.jsx)("svg",{className:"icon-product",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,b.jsx)("h3",{children:"Producto Generado"})]}),(0,b.jsxs)("div",{className:"product-details",children:[(0,b.jsxs)("div",{className:"product-name",children:[(0,b.jsx)("span",{className:"label",children:"Nombre"}),(0,b.jsx)("span",{className:"value",children:h.name})]}),(0,b.jsxs)("div",{className:"product-info-grid",children:[(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Precio"}),(0,b.jsxs)("div",{className:"price",children:[(0,b.jsx)("span",{className:"value",children:h.regular_price}),(0,b.jsx)("span",{className:"currency",children:"EUR"})]})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Categorías"}),(0,b.jsx)("div",{className:"categories",children:j.length>0?j.map((a,c)=>(0,b.jsx)("span",{className:"category-tag",children:a},c)):(0,b.jsx)("span",{className:"value",children:"Sin categorías"})})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Etiquetas"}),(0,b.jsx)("div",{className:"categories",children:i.length>0?i.map((a,c)=>(0,b.jsx)("span",{className:"category-tag",children:a},c)):(0,b.jsx)("span",{className:"value",children:"Sin etiquetas"})})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Stock"}),(0,b.jsx)("span",{className:"value",children:h.stock_quantity??"N/D"})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"SKU"}),(0,b.jsx)("span",{className:"value",children:h.sku||"N/D"})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Estado"}),(0,b.jsx)("span",{className:"value",children:l||"N/D"})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Tipo"}),(0,b.jsx)("span",{className:"value",children:h.type||"simple"})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Peso"}),(0,b.jsx)("span",{className:"value",children:h.weight||"N/D"})]}),(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Dimensiones"}),(0,b.jsx)("span",{className:"value",children:m?[h.dimensions?.length,h.dimensions?.width,h.dimensions?.height].filter(a=>a).join(" x "):"N/D"})]})]}),h.attributes&&h.attributes.length>0&&(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Atributos"}),(0,b.jsx)("div",{className:"attributes",children:h.attributes.map((a,c)=>(0,b.jsxs)("div",{className:"attribute-tag",children:[(0,b.jsxs)("span",{className:"attr-name",children:[a.name,":"]}),(0,b.jsx)("span",{className:"attr-value",children:a.value})]},c))})]}),k.length>0&&(0,b.jsxs)("div",{className:"info-item",children:[(0,b.jsx)("span",{className:"label",children:"Imágenes"}),(0,b.jsx)("div",{className:"images-list",children:k.map((a,c)=>(0,b.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"image-link",children:["Imagen ",c+1]},a))})]})]}),(0,b.jsxs)("div",{className:"action-buttons",children:[(0,b.jsxs)("button",{onClick:c,className:"btn btn-secondary",children:[(0,b.jsx)("svg",{className:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),(0,b.jsx)("span",{children:"Descargar CSV"})]}),(0,b.jsx)("button",{onClick:d,disabled:g,className:"btn btn-primary",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("svg",{className:"btn-icon animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,b.jsx)("span",{children:"Subiendo..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{className:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,b.jsx)("span",{children:"Subir a WooCommerce"})]})}),(0,b.jsxs)("button",{onClick:e,className:"btn btn-secondary",children:[(0,b.jsx)("svg",{className:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,b.jsx)("span",{children:"Nuevo Producto"})]})]})]})}let h=(a,b={})=>a?Array.from(new Set(a.split(/[\n,]+/).flatMap(a=>b.allowHierarchy?a.split(">"):[a]).map(a=>a.trim()).filter(a=>a.length>0))):[],i=a=>{if(!a)return;let b=a.replace(/[^0-9.,-]/g,"").replace(",",".");if(!b)return;let c=parseFloat(b);if(Number.isFinite(c))return Math.max(0,Math.round(c))},j=["name","price","shortDescription","longDescription","category","tags","images","stock","sku","status","productType","shipping","attributes","complete"],k={name:"¿Cuál es el título del producto?",price:"¿Cuál es el precio?",shortDescription:"Dame una descripción corta.",longDescription:"Ahora una descripción más completa.",category:"¿En qué categoría lo metemos?",tags:"¿Quieres añadir etiquetas?",images:"¿Qué imágenes quieres usar? (URL o generar con IA)",stock:"¿Cuánto stock tiene?",sku:"¿Cuál es el SKU?",status:"¿Publicamos el producto o lo dejamos como borrador?",productType:"¿Qué tipo de producto es? (simple por defecto)",shipping:"Dame detalles de envío: peso y dimensiones",attributes:"¿Tiene atributos como color, talla o material?"},l={name:"",price:"",shortDescription:"",longDescription:"",category:"",tags:"",images:"",stock:"",sku:"",status:"",productType:"",shippingDetails:"",attributes:""},m="Voy a ayudarte a crear un producto nuevo. Empecemos por lo básico. ¿Cuál es el título del producto?";function n(){let[a,f]=(0,c.useState)(""),[n,o]=(0,c.useState)("name"),[p,q]=(0,c.useState)(m),[r,s]=(0,c.useState)(l),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),D=a=>{let b=j.indexOf(a);return j[b+1]||"complete"},E=async(a,b)=>{"complete"===a?(q("¡Perfecto! Estoy generando tu producto con toda la información..."),u(!0),await H(b)):(o(a),q(k[a]))},F=async b=>{if(b.preventDefault(),t)return;let c=a.trim();if(!c)return;f("");let d={...r};switch(n){case"name":d.name=c;break;case"price":d.price=c;break;case"shortDescription":d.shortDescription=c;break;case"longDescription":d.longDescription=c;break;case"category":d.category=c;break;case"tags":d.tags=c;break;case"images":d.images=c;break;case"stock":d.stock=c;break;case"sku":d.sku=c;break;case"status":d.status=c;break;case"productType":d.productType=c;break;case"shipping":d.shippingDetails=c;break;case"attributes":d.attributes=c}s(d);let e=D(n);await E(e,d)},G=async()=>{if(t||"complete"===n)return;let a=D(n);f(""),await E(a,r)},H=async a=>{y(""),w(null),C("");try{let b=h(a.category,{allowHierarchy:!0}),c=h(a.tags),d=h(a.images),e=i(a.stock),f=(a=>{let b=a.trim().toLowerCase();if(!b)return;if(b.includes("borrador")||b.includes("draft"))return"draft";if(b.includes("pend"))return"pending";if(b.includes("priv"))return"private";let c=b.replace(/[^a-záéíóúüñ\s]/g," ").split(/\s+/).filter(Boolean);if(b.includes("public")||b.includes("activar")||c.includes("si")||c.includes("sí"))return"publish"})(a.status),g=a.productType.trim().toLowerCase()||"simple",j=(a=>{let b;if(!a.trim())return{};let c=a=>{let b=a.replace(/[^0-9.,-]/g,"").replace(",",".");if(!b)return;let c=parseFloat(b);return Number.isFinite(c)?c:void 0},d=a=>{let b=Math.round(1e3*a)/1e3;return Number.isInteger(b)?String(b):b.toString()},e=a.match(/peso\s*: ?([\d.,]+)\s*([a-zA-Z]*)/i)||a.match(/weight\s*: ?([\d.,]+)\s*([a-zA-Z]*)/i);if(e){let a=c(e[1]);void 0!==a&&(b=d((e[2]||"").toLowerCase().startsWith("g")?a/1e3:a))}let f={},g=a.match(/dimensiones?\s*: ?([\d.,]+)\s*[xX]\s*([\d.,]+)\s*[xX]\s*([\d.,]+)/);if(g){let a=c(g[1]),b=c(g[2]),e=c(g[3]);void 0!==a&&(f.length=d(a)),void 0!==b&&(f.width=d(b)),void 0!==e&&(f.height=d(e))}else{let b=a.match(/(largo|longitud|length)\s*: ?([\d.,]+)/i),e=a.match(/(ancho|width)\s*: ?([\d.,]+)/i),g=a.match(/(alto|altura|height)\s*: ?([\d.,]+)/i);if(b){let a=c(b[2]);void 0!==a&&(f.length=d(a))}if(e){let a=c(e[2]);void 0!==a&&(f.width=d(a))}if(g){let a=c(g[2]);void 0!==a&&(f.height=d(a))}}return{weight:b,dimensions:Object.values(f).some(Boolean)?f:void 0}})(a.shippingDetails),k=(a=>{if(!a.trim())return[];let b=a.split(/[\n;]+/).flatMap(a=>a.split(",")).map(a=>a.trim()).filter(a=>a.length>0),c=new Map;return b.forEach(a=>{let[b,d]=a.split(/[:=|-]/).map(a=>a.trim());if(!b||!d)return;let e=b.toLowerCase();c.has(e)||c.set(e,{name:b,value:d,visible:!0,variation:!1})}),Array.from(c.values())})(a.attributes),l=a.images.toLowerCase().includes("generar");l&&(d=[]);let m=`T\xedtulo sugerido: ${a.name||"N/D"}
Precio indicado: ${a.price||"N/D"}
Descripci\xf3n corta: ${a.shortDescription||"N/D"}
Descripci\xf3n completa: ${a.longDescription||"N/D"}
Categor\xedas propuestas: ${b.length?b.join(" | "):a.category||"N/D"}
Etiquetas sugeridas: ${c.length?c.join(", "):a.tags||"N/D"}
Im\xe1genes proporcionadas: ${l?"El usuario prefiere generarlas con IA.":d.length?d.join(", "):a.images||"N/D"}
Stock indicado: ${a.stock||"N/D"}
SKU indicado: ${a.sku||"N/D"}
Estado deseado: ${f||a.status||"N/D"}
Tipo de producto: ${a.productType||"simple"}
Detalles de env\xedo: ${a.shippingDetails||"N/D"}
Atributos sugeridos: ${a.attributes||"N/D"}`,n={};a.name.trim()&&(n.name=a.name.trim()),a.shortDescription.trim()&&(n.short_description=a.shortDescription.trim()),a.longDescription.trim()&&(n.description=a.longDescription.trim()),a.price.trim()&&(n.regular_price=a.price.trim()),b.length&&(n.categories=b),c.length&&(n.tags=c),d.length&&(n.images=d),"number"==typeof e&&(n.stock_quantity=e),a.sku.trim()&&(n.sku=a.sku.trim()),f&&(n.status=f),n.type=g,j.weight&&(n.weight=j.weight),j.dimensions&&(n.dimensions=j.dimensions),k.length&&(n.attributes=k);let p=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:m,overrides:n})});if(!p.ok)throw Error("Failed to generate product");let r=await p.json(),s=(a=>{if(!a?.product)return a;let b=a.product,c=Array.isArray(b.categories)?b.categories:h(String(b.categories??""),{allowHierarchy:!0}),d=Array.isArray(b.tags)?b.tags:h(String(b.tags??"")),e=Array.isArray(b.images)?b.images:h(String(b.images??"")),f="number"==typeof b.stock_quantity?b.stock_quantity:i(String(b.stock_quantity??""));return{...a,product:{...b,categories:c,tags:d,images:e,stock_quantity:f??void 0,attributes:Array.isArray(b.attributes)?b.attributes:[]}}})(r);w(s),q(`✅ \xa1Producto generado exitosamente! "${s.product.name}" est\xe1 listo.`),o("complete")}catch(a){y("Ocurrió un error al generar el producto. Por favor, inténtalo de nuevo."),q("❌ Lo siento, hubo un error al generar el producto. Recarga la página para intentarlo de nuevo."),console.error(a)}finally{u(!1)}},I=async()=>{if(v?.product){A(!0),C(""),y("");try{let a=await fetch("/api/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product:v.product})}),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to upload product");C("¡Producto subido a WooCommerce con éxito!")}catch(a){y(a.message||"Error al subir el producto")}finally{A(!1)}}};return(0,b.jsx)("main",{className:"chat-container",children:(0,b.jsxs)("div",{className:"chat-wrapper",children:[(0,b.jsx)(d,{}),(0,b.jsxs)("div",{className:"chat-content",children:[(0,b.jsx)(e,{loading:t,currentMessage:p,currentStep:n,input:a,setInput:f,handleSendMessage:F,handleSkip:G,error:x,uploadSuccess:B}),v&&"complete"===n&&(0,b.jsx)(g,{result:v,downloadCSV:()=>{if(!v?.csv)return;let a=new Blob([v.csv],{type:"text/csv"}),b=window.URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download="products.csv",c.click()},handleUpload:I,resetChat:()=>{q(m),o("name"),s(l),w(null),y(""),C(""),f("")},uploading:z})]})]})})}a.s(["default",()=>n],40777)}];

//# sourceMappingURL=src_app_page_tsx_a7111f3e._.js.map